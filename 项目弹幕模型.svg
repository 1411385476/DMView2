<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1287px" preserveAspectRatio="none" style="width:1142px;height:1287px;" version="1.1" viewBox="0 0 1142 1287" width="1142px" zoomAndPan="magnify"><defs><filter height="300%" id="f1fhqcsynevmbi" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="570.75" cy="20" fill="#000000" filter="url(#f1fhqcsynevmbi)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#000000" filter="url(#f1fhqcsynevmbi)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="1121.5" x="10" y="50"/><path d="M24,127.2085 L24,235.9805 A0,0 0 0 0 24,235.9805 L175,235.9805 A0,0 0 0 0 175,235.9805 L175,185.5945 L195,181.5945 L175,177.5945 L175,137.2085 L165,127.2085 L24,127.2085 A0,0 0 0 0 24,127.2085 " fill="#FBFB77" filter="url(#f1fhqcsynevmbi)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M165,127.2085 L165,137.2085 L175,137.2085 L165,127.2085 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="30" y="147.1064">定义弹幕对象的优先级</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="24" x2="175" y1="154.9629" y2="154.9629"/><ellipse cx="35.5" cy="170.2173" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="43" y="174.8608">0~9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="30" y="192.6152">待定优先级，预留数字</text><ellipse cx="35.5" cy="205.7261" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="36" x="43" y="210.3696">10~19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="30" y="228.124">弹幕特权优先级</text><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="211" x="195" y="155.2058"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="120" x="205" y="178.9578">初始化一个优先级队列</text><text fill="#008000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="325" y="178.9578">queue</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="36" x="360" y="178.9578">，用来</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="132" x="205" y="195.3464">存放所有需要播放的弹幕</text><ellipse cx="300.5" cy="280.9805" fill="none" filter="url(#f1fhqcsynevmbi)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="301" cy="281.4805" fill="#000000" filter="url(#f1fhqcsynevmbi)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="229" x="437.5" y="76"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="447.5" y="99.752">初始化一个列表</text><text fill="#FFA500" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="77" x="531.5" y="99.752">refreshDMList</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="608.5" y="99.752">，用来存</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="144" x="447.5" y="116.1406">放需要更新到画布上的弹幕</text><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="188" x="458" y="226.8003"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="168" x="468" y="250.5522">每隔多少秒刷新一下展示的画面</text><polygon fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" points="519,163.7773,585,163.7773,597,175.7773,585,187.7773,519,187.7773,507,175.7773,519,163.7773" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="556" y="200.3833">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="519" y="180.8718">监听到有数据</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="495" y="173.3604">no</text><ellipse cx="552" cy="320.9805" fill="none" filter="url(#f1fhqcsynevmbi)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="552.5" cy="321.4805" fill="#000000" filter="url(#f1fhqcsynevmbi)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="694.5" y="155.2058"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="140" x="704.5" y="178.9578">创建一个SurfaceView，用</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="60" x="704.5" y="195.3464">来展示弹幕</text><ellipse cx="774.5" cy="252.9832" fill="none" filter="url(#f1fhqcsynevmbi)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="775" cy="253.4832" fill="#000000" filter="url(#f1fhqcsynevmbi)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="235" x="882.5" y="155.2058"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="892.5" y="178.9578">创建一个弹幕回收库</text><text fill="#0000FF" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="1000.5" y="178.9578">dmRecycling</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="36" x="1071.5" y="178.9578">，用来</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="892.5" y="195.3464">回收用过的弹幕对象</text><ellipse cx="1000" cy="252.9832" fill="none" filter="url(#f1fhqcsynevmbi)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="1000.5" cy="253.4832" fill="#000000" filter="url(#f1fhqcsynevmbi)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><rect fill="#000000" filter="url(#f1fhqcsynevmbi)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="1121.5" x="10" y="340.9805"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="430" x2="816.25" y1="366.9805" y2="366.9805"/><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="116" x="372" y="386.9805"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="96" x="382" y="410.7324">收到一个弹幕数据</text><polygon fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" points="372,458.3691,488,458.3691,500,470.3691,488,482.3691,372,482.3691,360,470.3691,372,458.3691" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="116" x="372" y="475.4636">dmRecycling.size() == 0</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="342" y="467.9521">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="500" y="467.9521">no</text><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="244.25" y="492.3691"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="254.25" y="516.1211">创建一个弹幕对象：</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="362.25" y="516.1211">dm</text><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="265" x="410.25" y="492.3691"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="420.25" y="516.1211">dm</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="438.25" y="516.1211">赋值：从</text><text fill="#0000FF" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="486.25" y="516.1211">dmRecycling</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="557.25" y="516.1211">获取一个弹幕对象，</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="156" x="420.25" y="532.5098">并从列表中移除该对象的引用</text><polygon fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" points="430,551.1465,442,563.1465,430,575.1465,418,563.1465,430,551.1465" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="101.9434" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="381" y="608.1465"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="386" x2="386" y1="608.1465" y2="710.0898"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="474" x2="474" y1="608.1465" y2="710.0898"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="36" x="391" y="631.8984">初始化</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="427" y="631.8984">dm</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="24" x="445" y="631.8984">数据</text><ellipse cx="396.5" cy="643.4238" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="24" x="402" y="648.2871">头像</text><ellipse cx="396.5" cy="659.8125" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="24" x="402" y="664.6758">昵称</text><ellipse cx="396.5" cy="676.2012" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="402" y="681.0645">消息数据</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="18" x="391" y="697.4531">......</text><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="353.5" y="745.0898"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="363.5" y="768.8418">offer(</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="391.5" y="768.8418">dm</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="52" x="409.5" y="768.8418">)放入队列</text><text fill="#008000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="461.5" y="768.8418">queue</text><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="744.25" y="416.4407"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="106" x="754.25" y="440.1926">某一个play了的弹幕</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="860.25" y="440.1926">dm</text><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="737.25" y="550.8523"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="60" x="747.25" y="574.6042">更新该弹幕</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="807.25" y="574.6042">dm</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="60" x="825.25" y="574.6042">的位置信息</text><polygon fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" points="754.75,487.8293,877.75,487.8293,889.75,499.8293,877.75,511.8293,754.75,511.8293,742.75,499.8293,754.75,487.8293" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="820.25" y="524.4353">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="33" x="754.75" y="504.9238">该弹幕</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="787.75" y="504.9238">dm</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="72" x="805.75" y="504.9238">是否正在运行?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="730.75" y="497.4124">no</text><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="163" x="734.75" y="644.241"/><text fill="#FFA500" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="77" x="744.75" y="667.9929">refreshDMList</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="821.75" y="667.9929">中移除该</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="869.75" y="667.9929">dm</text><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="145" x="743.75" y="715.6296"/><text fill="#0000FF" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="753.75" y="739.3816">dmRecycling</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="36" x="824.75" y="739.3816">添加该</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="860.75" y="739.3816">dm</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="430" x2="816.25" y1="801.4785" y2="801.4785"/><polygon fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" points="477.25,921.959,664.25,921.959,676.25,933.959,664.25,945.959,477.25,945.959,465.25,933.959,477.25,921.959" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#FFA500" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="77" x="477.25" y="939.5166">refreshDMList</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="110" x="554.25" y="939.7363">达到屏幕展示最大数量</text><ellipse cx="706.25" cy="933.959" fill="none" filter="url(#f1fhqcsynevmbi)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="706.75" cy="934.459" fill="#000000" filter="url(#f1fhqcsynevmbi)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="504.25" y="965.959"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="514.25" y="989.7109">移除并得到队头弹幕</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="517.25" y="1006.0996">dm =</text><text fill="#008000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="548.25" y="1006.0996">queue</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="44" x="583.25" y="1006.0996">.remove</text><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="85.5547" style="stroke: #A80036; stroke-width: 1.5;" width="116" x="512.75" y="1038.7363"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="517.75" x2="517.75" y1="1038.7363" y2="1124.291"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="623.75" x2="623.75" y1="1038.7363" y2="1124.291"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="96" x="522.75" y="1062.4883">设置弹幕位置数据</text><ellipse cx="528.25" cy="1074.0137" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="533.75" y="1078.877">弹幕的开始位置</text><ellipse cx="528.25" cy="1090.4023" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="533.75" y="1095.2656">弹幕的结束位置</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="21" x="522.75" y="1111.6543">.......</text><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="36.3887" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="151" x="495.25" y="1144.291"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="24" x="505.25" y="1168.043">添加</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="529.25" y="1168.043">dm</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="12" x="547.25" y="1168.043">到</text><text fill="#FFA500" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="77" x="559.25" y="1168.043">refreshDMList</text><rect fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" height="52.7773" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="506.75" y="1200.6797"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="516.75" y="1224.4316">开启该弹幕路径动画</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="0" x="519.75" y="1240.8203"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="519.75" y="1240.8203">dm</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="33" x="537.75" y="1240.8203">.play()</text><polygon fill="#FEFECE" filter="url(#f1fhqcsynevmbi)" points="515.75,821.4785,625.75,821.4785,637.75,852.2073,625.75,882.936,515.75,882.936,503.75,852.2073,515.75,821.4785" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="574.75" y="895.542">有</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="518.75" y="834.0845"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="110" x="515.75" y="849.1074">队列是否有弹幕数据？</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="518.75" y="865.4961"/><text fill="#008000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="518.75" y="865.2764">queue</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="553.75" y="865.4961">.peek() != null</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="518.75" y="880.519"/><ellipse cx="455.25" cy="923.6648" fill="none" filter="url(#f1fhqcsynevmbi)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="455.75" cy="924.1648" fill="#000000" filter="url(#f1fhqcsynevmbi)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="300.5" x2="300.5" y1="207.9832" y2="270.9805"/><polygon fill="#A80036" points="296.5,260.9805,300.5,270.9805,304.5,260.9805,300.5,264.9805" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="552" x2="552" y1="187.7773" y2="226.8003"/><polygon fill="#A80036" points="548,216.8003,552,226.8003,556,216.8003,552,220.8003" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="552" x2="552" y1="263.189" y2="275.189"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="552" x2="658" y1="275.189" y2="275.189"/><polygon fill="#A80036" points="654,235.4832,658,225.4832,662,235.4832,658,231.4832" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="658" x2="658" y1="175.7773" y2="275.189"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="658" x2="597" y1="175.7773" y2="175.7773"/><polygon fill="#A80036" points="607,171.7773,597,175.7773,607,179.7773,603,175.7773" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="507" x2="446" y1="175.7773" y2="175.7773"/><polygon fill="#A80036" points="442,221.4832,446,231.4832,450,221.4832,446,225.4832" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="446" x2="446" y1="175.7773" y2="287.189"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="446" x2="552" y1="287.189" y2="287.189"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="552" x2="552" y1="287.189" y2="310.9805"/><polygon fill="#A80036" points="548,300.9805,552,310.9805,556,300.9805,552,304.9805" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="552" x2="552" y1="128.7773" y2="163.7773"/><polygon fill="#A80036" points="548,153.7773,552,163.7773,556,153.7773,552,157.7773" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="774.5" x2="774.5" y1="207.9832" y2="242.9832"/><polygon fill="#A80036" points="770.5,232.9832,774.5,242.9832,778.5,232.9832,774.5,236.9832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1000" x2="1000" y1="207.9832" y2="242.9832"/><polygon fill="#A80036" points="996,232.9832,1000,242.9832,1004,232.9832,1000,236.9832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="300.5" x2="300.5" y1="56" y2="155.2058"/><polygon fill="#A80036" points="296.5,145.2058,300.5,155.2058,304.5,145.2058,300.5,149.2058" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="552" x2="552" y1="56" y2="76"/><polygon fill="#A80036" points="548,66,552,76,556,66,552,70" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="774.5" x2="774.5" y1="56" y2="155.2058"/><polygon fill="#A80036" points="770.5,145.2058,774.5,155.2058,778.5,145.2058,774.5,149.2058" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1000" x2="1000" y1="56" y2="155.2058"/><polygon fill="#A80036" points="996,145.2058,1000,155.2058,1004,145.2058,1000,149.2058" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="570.75" x2="570.75" y1="30" y2="50"/><polygon fill="#A80036" points="566.75,40,570.75,50,574.75,40,570.75,44" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="360" x2="317.25" y1="470.3691" y2="470.3691"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="317.25" x2="317.25" y1="470.3691" y2="492.3691"/><polygon fill="#A80036" points="313.25,482.3691,317.25,492.3691,321.25,482.3691,317.25,486.3691" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="500" x2="542.75" y1="470.3691" y2="470.3691"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="542.75" x2="542.75" y1="470.3691" y2="492.3691"/><polygon fill="#A80036" points="538.75,482.3691,542.75,492.3691,546.75,482.3691,542.75,486.3691" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="317.25" x2="317.25" y1="528.7578" y2="563.1465"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="317.25" x2="418" y1="563.1465" y2="563.1465"/><polygon fill="#A80036" points="408,559.1465,418,563.1465,408,567.1465,412,563.1465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="542.75" x2="542.75" y1="545.1465" y2="563.1465"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="542.75" x2="442" y1="563.1465" y2="563.1465"/><polygon fill="#A80036" points="452,559.1465,442,563.1465,452,567.1465,448,563.1465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="430" x2="430" y1="423.3691" y2="458.3691"/><polygon fill="#A80036" points="426,448.3691,430,458.3691,434,448.3691,430,452.3691" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="430" x2="430" y1="575.1465" y2="608.1465"/><polygon fill="#A80036" points="426,598.1465,430,608.1465,434,598.1465,430,602.1465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="430" x2="430" y1="710.0898" y2="745.0898"/><polygon fill="#A80036" points="426,735.0898,430,745.0898,434,735.0898,430,739.0898" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="816.25" x2="816.25" y1="511.8293" y2="550.8523"/><polygon fill="#A80036" points="812.25,540.8523,816.25,550.8523,820.25,540.8523,816.25,544.8523" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="816.25" x2="816.25" y1="587.241" y2="597.241"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="816.25" x2="907.25" y1="597.241" y2="597.241"/><polygon fill="#A80036" points="903.25,559.5352,907.25,549.5352,911.25,559.5352,907.25,555.5352" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="907.25" x2="907.25" y1="499.8293" y2="597.241"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="907.25" x2="889.75" y1="499.8293" y2="499.8293"/><polygon fill="#A80036" points="899.75,495.8293,889.75,499.8293,899.75,503.8293,895.75,499.8293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="742.75" x2="725.25" y1="499.8293" y2="499.8293"/><polygon fill="#A80036" points="721.25,545.5352,725.25,555.5352,729.25,545.5352,725.25,549.5352" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="725.25" x2="725.25" y1="499.8293" y2="609.241"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="725.25" x2="816.25" y1="609.241" y2="609.241"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="816.25" x2="816.25" y1="609.241" y2="644.241"/><polygon fill="#A80036" points="812.25,634.241,816.25,644.241,820.25,634.241,816.25,638.241" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="816.25" x2="816.25" y1="452.8293" y2="487.8293"/><polygon fill="#A80036" points="812.25,477.8293,816.25,487.8293,820.25,477.8293,816.25,481.8293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="816.25" x2="816.25" y1="680.6296" y2="715.6296"/><polygon fill="#A80036" points="812.25,705.6296,816.25,715.6296,820.25,705.6296,816.25,709.6296" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="430" x2="430" y1="368.4805" y2="386.9805"/><polygon fill="#A80036" points="426,376.9805,430,386.9805,434,376.9805,430,380.9805" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="816.25" x2="816.25" y1="368.4805" y2="416.4407"/><polygon fill="#A80036" points="812.25,406.4407,816.25,416.4407,820.25,406.4407,816.25,410.4407" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="430" x2="430" y1="781.4785" y2="801.4785"/><polygon fill="#A80036" points="426,791.4785,430,801.4785,434,791.4785,430,795.4785" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="816.25" x2="816.25" y1="752.0183" y2="801.4785"/><polygon fill="#A80036" points="812.25,791.4785,816.25,801.4785,820.25,791.4785,816.25,795.4785" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="570.75" x2="570.75" y1="346.9805" y2="366.9805"/><polygon fill="#A80036" points="566.75,356.9805,570.75,366.9805,574.75,356.9805,570.75,360.9805" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="570.75" x2="570.75" y1="945.959" y2="965.959"/><polygon fill="#A80036" points="566.75,955.959,570.75,965.959,574.75,955.959,570.75,959.959" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="676.25" x2="696.25" y1="933.959" y2="933.959"/><polygon fill="#A80036" points="686.25,929.959,696.25,933.959,686.25,937.959,690.25,933.959" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="570.75" x2="570.75" y1="1018.7363" y2="1038.7363"/><polygon fill="#A80036" points="566.75,1028.7363,570.75,1038.7363,574.75,1028.7363,570.75,1032.7363" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="570.75" x2="570.75" y1="1124.291" y2="1144.291"/><polygon fill="#A80036" points="566.75,1134.291,570.75,1144.291,574.75,1134.291,570.75,1138.291" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="570.75" x2="570.75" y1="1180.6797" y2="1200.6797"/><polygon fill="#A80036" points="566.75,1190.6797,570.75,1200.6797,574.75,1190.6797,570.75,1194.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="570.75" x2="570.75" y1="882.936" y2="921.959"/><polygon fill="#A80036" points="566.75,911.959,570.75,921.959,574.75,911.959,570.75,915.959" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="570.75" x2="570.75" y1="1253.457" y2="1263.457"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="570.75" x2="740.25" y1="1263.457" y2="1263.457"/><polygon fill="#A80036" points="736.25,1044.8322,740.25,1034.8322,744.25,1044.8322,740.25,1040.8322" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="740.25" x2="740.25" y1="852.2073" y2="1263.457"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="740.25" x2="637.75" y1="852.2073" y2="852.2073"/><polygon fill="#A80036" points="647.75,848.2073,637.75,852.2073,647.75,856.2073,643.75,852.2073" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="503.75" x2="455.25" y1="852.2073" y2="852.2073"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="455.25" x2="455.25" y1="852.2073" y2="913.6648"/><polygon fill="#A80036" points="451.25,903.6648,455.25,913.6648,459.25,903.6648,455.25,907.6648" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="570.75" x2="570.75" y1="802.9785" y2="821.4785"/><polygon fill="#A80036" points="566.75,811.4785,570.75,821.4785,574.75,811.4785,570.75,815.4785" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
start
fork
    :初始化一个优先级队列<font size="12" color="green">queue</font>，用来
    存放所有需要播放的弹幕;
    note left
定义弹幕对象的优先级
- - - -
*<b>0~9</b>
待定优先级，预留数字
*<b>10~19</b>
弹幕特权优先级
    end note
    stop
fork again
    :初始化一个列表<font size="12" color="orange">refreshDMList</font>，用来存
    放需要更新到画布上的弹幕;
    while (监听到有数据) is (yes)
        :每隔多少秒刷新一下展示的画面;
    end while(no)
    stop
fork again
    :创建一个SurfaceView，用
    来展示弹幕;
    stop
fork again
    :创建一个弹幕回收库<font size="12" color="blue">dmRecycling</font>，用来
    回收用过的弹幕对象;
    stop
end fork
split
    :收到一个弹幕数据;
    if (dmRecycling.size() == 0) then (yes)
        :创建一个弹幕对象：**dm**;
    else (no)
        :**dm**赋值：从<font size="12" color="blue">dmRecycling</font>获取一个弹幕对象，
        并从列表中移除该对象的引用;
    endif
    :初始化**dm**数据
*头像
*昵称
*消息数据
......|
    :offer(**dm**)放入队列<font size="12" color="green">queue</font>;
split again
:某一个play了的弹幕**dm**;
    while(该弹幕**dm**是否正在运行?) is (yes)
        :更新该弹幕**dm**的位置信息;
    end while(no)
    :<font size="12" color="orange">refreshDMList</font>中移除该**dm**;
    :<font size="12" color="blue">dmRecycling</font>添加该**dm**;
end split

while (\n队列是否有弹幕数据？\n <font size="12" color="green">queue</font>.peek() != null\n) is (有)
    if(<font size="12" color="orange">refreshDMList</font>达到屏幕展示最大数量) then
    stop
    endif
    :移除并得到队头弹幕\n dm = <font size="12" color="green">queue</font>.remove;
:设置弹幕位置数据
*弹幕的开始位置
*弹幕的结束位置
.......|
:添加**dm**到<font size="12" color="orange">refreshDMList</font>;
    :开启该弹幕路径动画\n **dm**.play();

end while
stop
@enduml

PlantUML version 1.2018.01(Mon Jan 29 02:08:22 CST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-915-b01
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg>